---
- name: Install packages (for cargo, memcached, postgres and ansible)
  ansible.builtin.apt:
    name: "{{ item }}"
    update_cache: true
  loop:
    - cargo
    - libssl-dev
    - pkg-config
    - libmemcached-tools
    - memcached
    - postgresql
    - python3-jmespath
    - python3-pip
  tags:
    - ivynet_backend
    - memcached
    - postgres
    - download
    - sqlx

- name: Install SQLX (to run migrtion)
  community.general.cargo:
    name: sqlx-cli
    path: "{{ ivynet_backend_path_install }}"
    state: latest
  vars:
    ansible_command_timeout: 1200
  tags:
    - ivynet_backend
    - download
    - sqlx

- name: Install extra python packages(for github access)
  ansible.builtin.pip:  # noqa: package-latest
    name: "{{ item }}"
    state: latest
    break_system_packages: true
  loop:
    - github3.py
    - psycopg2-binary
  tags:
    - ivynet_backend
    - general
    - download
    - github
    - postgres
